<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.wzx.dao.NewsDao">
	
	<!-- 删除 -->
	<update id="delNews" parameterType="int">
		update news set yes='no' where id=#{id}
	</update>
	<!-- 添加 -->
	<insert id="addNews" parameterType="news">
		insert into news(name,pwd,age,nickname) values(#{name},#{pwd},#{age},#{nickname})
	</insert>
	<!-- 查询 -->
	<select id="queryNews" parameterType="fenye" resultType="news">
		select * from news where yes='yes' 
			<if test="search.title !=null and search.title !=''">
				and title like concat('%',concat(#{search.qtitle},'%'))
			</if>
			<if test="search.context!=null and search.context!=''">
				and context like concat('%',concat(#{search.qcontext},'%'))
			</if>
			limit #{startRow},#{endRow} 		
	</select>
	<!-- 总行数 -->
	<select id="rowCount" parameterType="fenye" resultType="int">
		select count(*) from news where yes='yes'
			<if test="search.title !=null and search.title !=''">
				and title like concat('%',concat(#{search.qtitle},'%'))
			</if>
			<if test="search.context!=null and search.context!=''">
				and context like concat('%',concat(#{search.qcontext},'%'))
			</if>
	</select>
	<!-- 修改 -->
	<update id="update" parameterType="news">
		update news 
		<trim prefix="set" suffixOverrides=",">
			<if test="newsid !=null and newsid !=''">
				newsid=#{newsid},
			</if>
			<if test="title !=null and title !=''">
				title=#{title},
			</if>
			<if test="context !=null and context !=''">
				context=#{context},
			</if>
			<if test="newsman !=null and newsman !=''">
				newsman=#{newsman},
			</if>
			<if test="newsdate !=null">
				newsdate=#{newsdate},
			</if>
			<if test="pic !=null and pic !=''">
				pic=#{pic},
			</if>
		</trim>
		where id=#{id}
	</update>
	<!-- 查询单个 -->
	<select id="queryById" parameterType="int">
		select * from news where id=#{id}
	</select>
</mapper>
